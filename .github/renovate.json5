{
  $schema: "https://docs.renovatebot.com/renovate-schema.json",
  extends: [
    "config:base",
    ":gitSignOff", // Add commit Sign-Off for renovate commits
  ],

  // Allow only certain package managers and implicitly disable all others
  enabledManagers: ["dockerfile", "github-actions", "custom.regex"],

  baseBranches: ["main"],
  prConcurrentLimit: 5,
  prHourlyLimit: 0,

  labels: ["dependencies"],

  // Enabling security updates based on GitHub's Dependabot-style security alerts
  vulnerabilityAlerts: {
    enabled: true,
  },

  customManagers: [
    {
      customType: "regex",
      managerFilePatterns: ["images/tshark/Dockerfile"],
      matchStrings: [
        "apt-get install.*?tshark=(?<currentValue>[^\\s&]+)",
      ],
      depNameTemplate: "tshark",
      datasourceTemplate: "deb",
      registryUrlTemplate: "https://archive.ubuntu.com/ubuntu?suite=noble&components=main,universe&binaryArch=amd64",
    },
  ],

  packageRules: [
    // Limiting Docker updates to certain path
    {
      matchManagers: ["dockerfile"],
      enabled: false,
    },

    {
      matchManagers: ["dockerfile"],
      matchFileNames: ["images/toolbox/*"],
      addLabels: ["docker"],
      enabled: true,
    },

    {
      matchManagers: ["dockerfile"],
      matchFileNames: ["images/tshark/*"],
      addLabels: ["docker"],
      enabled: true,
    },

    // this should update the image sha, but not the tag
    {
      matchManagers: ["dockerfile"],
      matchPackageNames: ["ubuntu"],
      matchUpdateTypes: ["major", "minor"],
      enabled: false,
    },

    {
      matchManagers: ["custom.regex"],
      matchFileNames: ["images/tshark/*"],
      addLabels: ["docker"],
      enabled: true,
    },

    {
      matchManagers: ["github-actions"],
      addLabels: ["github_actions"],
    },
  ],
}
